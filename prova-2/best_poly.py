import numpy as np

def best_poly (x, y, k):
    n = len(x)
    if n <= k:
        raise ValueError('O número de pontos deve ser maior que k (o grau do polinômio)')

    somas = {}
    somas[0] = n
    for n in range(1, 2*k + 1):
        somas[n] = sum(xi ** n for xi in x)
    A = []
    B = []
    for i in range (k + 1):
        row = []
        for j in range(k + 1):
            row.append(somas[i + j])
        A.append(row)
        if i == 0:
            B.append(sum(y))
        else:
            B.append(sum(xi ** i * yi for xi, yi in zip(x,y)))
    return np.linalg.solve(A, B)

# x = [-1, 0, 1, 3]
# y = [0, 2, 1, 2]

x = [0.0967, 0.1693, 0.2718, 0.4258, 0.4817, 0.6557, 0.7256, 0.8852, 1.0018, 1.0712, 1.2745, 1.3879, 1.4819, 1.5434, 1.7396, 1.7928, 1.9623, 2.0909, 2.1147, 2.2733, 2.3466, 2.4657, 2.6738, 2.7736, 2.8386, 2.946, 3.0349, 3.2502, 3.3485, 3.4177, 3.5942, 3.6958, 3.7535, 3.8474, 4.0154, 4.0908, 4.2062, 4.3732, 4.4304, 4.6503, 4.703, 4.7993, 4.8927, 5.0575, 5.2015, 5.2368, 5.462, 5.525, 5.5995, 5.7105, 5.8731, 5.9644, 6.1425, 6.2411, 6.323, 6.4447, 6.5784, 6.7223, 6.8286, 6.9552, 7.0423, 7.1841, 7.2329, 7.421, 7.4492, 7.5854, 7.7274, 7.8153, 8.0112, 8.0521, 8.1853, 8.2876, 8.4221, 8.5022, 8.6632, 8.7944, 8.9185, 9.0476, 9.127, 9.222, 9.3118, 9.4919, 9.5718, 9.6616, 9.845, 9.9401]
y = [7.1132, 6.2721, 6.2732, 5.8729, 5.8748, 5.729, 5.6381, 5.6543, 5.5322, 5.5519, 5.1557, 4.4724, 5.4326, 4.1759, 5.4135, 5.2326, 5.1164, 5.0296, 4.7025, 4.5608, 4.5392, 4.7428, 4.6981, 4.0825, 4.3309, 4.2393, 4.5315, 4.235, 4.2095, 4.9785, 3.9183, 4.2613, 2.3097, 4.1794, 4.103, 3.9303, 3.9735, 4.2365, 2.6665, 3.9715, 4.364, 3.0872, 3.8076, 3.5841, 3.9974, 3.8698, 3.867, 4.6861, 5.5956, 4.2797, 3.9109, 3.0275, 3.9146, 4.0108, 3.85, 3.7338, 4.5887, 3.9757, 4.0311, 3.5789, 3.5666, 5.0986, 4.3684, 4.468, 4.274, 4.4805, 4.1556, 4.2355, 3.6386, 4.9289, 4.5629, 4.5309, 4.7395, 4.9938, 4.0596, 5.1535, 4.8706, 5.7937, 5.2197, 6.6573, 3.7234, 5.4029, 5.7568, 5.4934, 5.5307, 6.7951]

#a0, a1 = best_poly(x, y, 1)
#print(f'{a0 = } e {a1 = }')


# parabola
a0, a1, a2 = best_poly(x, y, 2)
print(f'{a0 = }, {a1 = }, {a2 = }')
