import numpy as np

def best_line(x, y):
    n = len(x)
    # soma das coordenadas x
    sum_x = sum(x)
    # soma das coordenadas x**2
    sum_x2 = sum(xi ** 2 for xi in x)
    # soma das coordenadas y
    sum_y = sum(y)
    #soma das coordenadas x*y
    sum_xy = sum(xi * yi for xi, yi in zip(x, y))

    # Matriz dos coeficientes
    A = [[n, sum_x], [sum_x, sum_x2]]
    # Matriz dos termos independentes
    B = [sum_y, sum_xy]

    return np.linalg.solve(A, B)

# exemplo:
# x = [0.1874, 0.4724, 0.7026, 1.0809, 1.3416, 1.7356, 1.915, 2.3421, 2.6942, 2.909, 3.1581, 3.5892, 3.8881, 4.1022, 4.6041, 4.7027, 5.0634, 5.5868, 5.6271, 6.081, 6.3221, 6.8617, 6.8779, 7.4928, 7.5439, 8.0425, 8.1843, 8.5707, 8.7942, 9.3378, 9.5886, 9.8648]
# y = [2.383, 0.9152, 1.1106, 0.3388, -0.3647, -0.7094, -1.5132, -1.925, -2.6547, -3.9432, -2.0927, -4.8607, -5.2777, -5.4443, -6.4531, -6.837, -9.2587, -7.9889, -6.8167, -9.6766, -9.9213, -10.1787, -10.6779, -12.3747, -12.707, -14.4612, -13.8262, -14.5971, -15.0886, -16.51, -17.7691, -17.1981]

# x = [0.0496, 0.1274, 0.2796, 0.4337, 0.5917, 0.6196, 0.824, 0.8789, 1.0653, 1.152, 1.2856, 1.4003, 1.5565, 1.5743, 1.805, 1.8915, 1.9706, 2.0987, 2.1822, 2.3755, 2.5086, 2.5329, 2.6881, 2.7972, 2.9733, 3.0354, 3.1861, 3.295, 3.4715, 3.5395, 3.6213, 3.8551, 3.8729, 4.0472, 4.1485, 4.3108, 4.4134, 4.5226, 4.6118, 4.7383, 4.9329, 5.0328, 5.1533, 5.3, 5.4136, 5.5086, 5.5891, 5.7791, 5.9003, 5.971, 6.0736, 6.1998, 6.2997, 6.4169, 6.6, 6.6361, 6.7571, 6.9815, 7.0503, 7.2263, 7.2917, 7.4242, 7.5262, 7.6328, 7.7748, 7.8329, 8.0329, 8.1543, 8.1944, 8.3804, 8.5053, 8.589, 8.688, 8.8781, 8.9323, 9.1131, 9.2064, 9.3049, 9.4297, 9.6037, 9.7573, 9.7624, 9.9754]
# y = [0.1837, 0.5443, 1.6907, 0.9433, 1.473, 1.3266, 2.0231, 1.9007, 2.1152, 2.264, 2.5864, 2.8629, 3.3771, 3.1296, 3.5638, 3.7109, 4.1762, 3.5261, 4.5321, 4.6253, 5.2316, 5.6458, 5.2496, 5.6806, 6.1768, 6.195, 6.2386, 6.9299, 8.1034, 7.5198, 7.95, 7.5532, 7.4873, 7.3865, 8.5114, 8.6054, 9.7558, 8.7552, 7.5336, 10.419, 9.6116, 10.1072, 11.3019, 10.3795, 10.7578, 11.2372, 11.2108, 11.6363, 11.4834, 11.6504, 11.8476, 12.2885, 12.7757, 12.4618, 13.1589, 12.3911, 13.5267, 14.4037, 13.6659, 12.7562, 14.1869, 14.661, 14.9603, 14.8645, 15.8289, 14.9681, 15.8564, 16.0723, 17.379, 16.3315, 16.6045, 16.9502, 17.3114, 18.1014, 17.696, 18.0206, 18.3328, 18.1271, 18.5542, 18.9318, 19.3837, 19.1122, 19.3515]

a0, a1 = best_line(x, y)

print(f'{a0 = } e {a1 = }')